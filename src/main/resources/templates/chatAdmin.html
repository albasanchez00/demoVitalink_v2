<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MensajerÃ­a â€” Admin</title>
    <link rel="shortcut icon" th:href="@{/media/favicon_IA_Medica.ico}" type="image/x-icon">
    <link rel="stylesheet" th:href="@{/css/style2.css}" type="text/css">
</head>
<body data-currentuser="admin">
<div th:replace="~{fragments/header :: header}"></div>

<!-- ===== CHAT ADMIN â€” estructura idÃ©ntica a MÃ©dico ===== -->
<section id="admin-mensajeria" class="chatv2">
    <!-- LATERAL -->
    <aside id="chat-list">
        <div class="chatv2__sidehead">
            <h3>Conversaciones</h3>
            <span class="pill pill--muted" id="convCount" style="display:none"></span>
        </div>

        <!-- Crear conversaciÃ³n directa (habilitado tambiÃ©n en Admin) -->
        <div class="crear-conv">
            <div class="crear-conv__form">
                <input id="nuevo-usuario" type="text" placeholder="Username del usuarioâ€¦">
                <button id="btn-crear" type="button">Nueva</button>
            </div>
            <small class="crear-conv__help">
                Crea o reabre una conversaciÃ³n DIRECT con el usuario indicado.
            </small>
        </div>

        <ul id="listaConversaciones" class="chat-list">
            <li class="empty-state">Cargando conversacionesâ€¦</li>
        </ul>

        <div class="pager">
            <button id="prev">Â«</button>
            <span id="pageInfo"></span>
            <button id="next">Â»</button>
            <select id="size">
                <option>10</option>
                <option selected>20</option>
                <option>50</option>
            </select>
        </div>
    </aside>


    <!-- PANEL DE CHAT -->
    <main id="chat-panel">
        <!-- Cabecera -->
        <header class="chatv2__head">
            <button class="back-btn" type="button" aria-label="Volver">â†</button>
            <div class="title">
                <strong id="convTitle">Selecciona una conversaciÃ³n</strong>
                <span class="status"><span class="dot"></span> en lÃ­nea</span>
            </div>
            <div class="actions">
                <button class="ghost" title="Buscar">ğŸ”</button>
                <button class="ghost" title="Opciones">â‹¯</button>
            </div>
        </header>

        <!-- Mensajes -->
        <div id="mensajes" class="chatv2__messages" aria-live="polite">
            <div class="empty-state">Selecciona una conversaciÃ³n para ver los mensajes.</div>
        </div>

        <!-- Composer -->
        <form id="form-msg" class="chatv2__composer" autocomplete="off">
            <textarea id="msg" rows="1" placeholder="Escribe un mensajeâ€¦ (Enter para enviar)"></textarea>
            <button type="submit" class="send">Enviar</button>
        </form>
    </main>
</section>

<div th:replace="~{fragments/footer :: footer}"></div>

<!-- Script -->
<script defer th:src="@{/js/admin-mensajeria.js}"></script>
</body>
</html>
