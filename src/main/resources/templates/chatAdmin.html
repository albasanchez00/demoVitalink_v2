<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mensajería – Admin</title>
    <link rel="shortcut icon" th:href="@{/media/favicon_IA_Medica.ico}">
    <!-- ✅ Reutiliza los mismos estilos de chatMedico_FIXED.html -->
    <link rel="stylesheet" href="/css/style2.css">
</head>
<body data-currentuser="admin">
<div th:replace="~{fragments/header :: header}"></div>

<section id="admin-mensajeria">
    <aside id="chat-list">
        <div class="chatv2__sidehead">
            <h3>Mensajería Admin</h3>
            <span class="pill pill--danger" id="totalUnread" style="display:none">0</span>
        </div>

        <div class="crear-conv">
            <div class="crear-conv__form">
                <input id="nuevo-usuario" type="text" placeholder="Buscar o crear conversación...">
                <button id="btn-crear" type="button">Nueva</button>
            </div>
            <small class="crear-conv__help">Escribe el username del usuario</small>
        </div>

        <ul id="listaConversaciones" class="chat-list">
            <li class="empty-state">Cargando conversaciones...</li>
        </ul>

        <div class="pager">
            <button id="prev">«</button>
            <span id="pageInfo">-</span>
            <button id="next">»</button>
            <select id="size">
                <option>10</option>
                <option selected>20</option>
                <option>50</option>
            </select>
        </div>
    </aside>

    <main id="chat-panel">
        <header class="chatv2__head">
            <button class="back-btn" type="button" aria-label="Volver">←</button>
            <div class="title">
                <strong id="convTitle">Selecciona una conversación</strong>
                <span class="status">
                    <span class="dot"></span>
                    <span id="statusText">en línea</span>
                </span>
            </div>
        </header>

        <div id="mensajes" class="chatv2__messages">
            <div class="empty-state">Selecciona una conversación</div>
        </div>

        <form id="form-msg" class="chatv2__composer" autocomplete="off">
            <textarea id="msg" rows="1" placeholder="Escribe un mensaje..."></textarea>
            <button type="submit" class="send">Enviar</button>
        </form>
    </main>
</section>

<div th:replace="~{fragments/footer :: footer}"></div>

<script defer src="/webjars/sockjs-client/sockjs.min.js"></script>
<script defer src="/webjars/stomp-websocket/stomp.min.js"></script>
<script defer th:src="@{/js/admin-mensajeria.js}"></script>

</body>
</html>